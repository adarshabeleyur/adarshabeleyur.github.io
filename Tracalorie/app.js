const StorageCtrl={storeItem:function(e){let t;null===localStorage.getItem("items")?((t=[]).push(e),localStorage.setItem("items",JSON.stringify(t))):((t=JSON.parse(localStorage.getItem("items"))).push(e),localStorage.setItem("items",JSON.stringify(t)))},getItemsFromStorage:function(){let e;return e=null===localStorage.getItem("items")?[]:JSON.parse(localStorage.getItem("items"))},updateItemStorage:function(e){let t=JSON.parse(localStorage.getItem("items"));t.forEach(function(n,o){e.id===n.id&&t.splice(o,1,e)}),localStorage.setItem("items",JSON.stringify(t))},deleteItemFromStorage:function(e){let t=JSON.parse(localStorage.getItem("items"));t.forEach(function(n,o){e===n.id&&t.splice(o,1)}),localStorage.setItem("items",JSON.stringify(t))},clearItemsFromStorage:function(){localStorage.removeItem("items")}},ItemCtrl=function(){const e=function(e,t,n){this.id=e,this.name=t,this.calories=n},t={items:StorageCtrl.getItemsFromStorage(),currentItem:null,totalCalories:0};return{getItems:function(){return t.items},addItem:function(n,o){let i;return i=t.items.length>0?t.items[t.items.length-1].id+1:0,o=parseInt(o),newItem=new e(i,n,o),t.items.push(newItem),newItem},getItemById:function(e){let n=null;return t.items.forEach(function(t){t.id===e&&(n=t)}),n},updateItem:function(e,n){n=parseInt(n);let o=null;return t.items.forEach(function(i){i.id===t.currentItem.id&&(i.name=e,i.calories=n,o=i)}),o},deleteItem:function(e){const n=t.items.map(function(e){return e.id}).indexOf(e);t.items.splice(n,1)},clearAllItems:function(){t.items=[]},setCurrentItem:function(e){t.currentItem=e},getCurrentItem:function(){return t.currentItem},getTotalCalories:function(){let e=0;return t.items.forEach(function(t){e+=t.calories}),t.totalCalories=e,t.totalCalories},logData:function(){return t}}}(),UICtrl=function(){const e={itemList:"#item-list",listItems:"#item-list li",addbtn:".add-btn",updateBtn:".update-btn",deleteBtn:".delete-btn",backBtn:".back-btn",clearBtn:".clear-btn",itemNameInput:"#item-name",itemCaloriesInput:"#item-calories",totalCalories:".total-calories"};return{getSelectors:function(){return e},populateItemList:function(t){let n="";t.forEach(function(e){n+=`<li class="collection-item" id="item-${e.id}">\n                  <strong>${e.name}: </strong> <em>${e.calories} Calories</em>\n                  <a href="#" class="secondary-content">\n                    <i class="edit-item fa fa-pencil"></i>\n                  </a>\n                </li>`}),document.querySelector(e.itemList).innerHTML=n},getItemInput:function(){return{name:document.querySelector(e.itemNameInput).value,calories:document.querySelector(e.itemCaloriesInput).value}},addListItem:function(t){document.querySelector(e.itemList).style.display="block";const n=document.createElement("li");n.className="collection-item",n.id=`item-${t.id}`,n.innerHTML=`<strong>${t.name}: </strong> <em>${t.calories} Calories</em>\n                      <a href="javascript:void(0);" class="secondary-content">\n                        <i class="edit-item fa fa-pencil"></i>\n                      </a>`,document.querySelector(e.itemList).insertAdjacentElement("beforeend",n)},updateListItem:function(t){let n=document.querySelectorAll(e.listItems);(n=Array.from(n)).forEach(function(e){const n=e.getAttribute("id");n===`item-${t.id}`&&(document.querySelector(`#${n}`).innerHTML=`<strong>${t.name}: </strong> <em>${t.calories} Calories</em>\n                          <a href="javascript:void(0);" class="secondary-content">\n                            <i class="edit-item fa fa-pencil"></i>\n                          </a>`)})},deleteListItem:function(e){const t=`#item-${e}`;document.querySelector(t).remove()},clearInput:function(){document.querySelector(e.itemNameInput).value="",document.querySelector(e.itemCaloriesInput).value=""},addItemToForm:function(){document.querySelector(e.itemNameInput).value=ItemCtrl.getCurrentItem().name,document.querySelector(e.itemCaloriesInput).value=ItemCtrl.getCurrentItem().calories,UICtrl.showEditState()},removeListItems:function(){let t=document.querySelectorAll(e.listItems);(t=Array.from(t)).forEach(function(e){e.remove()})},hideList:function(){document.querySelector(e.itemList).style.display="none"},showTotalCalories:function(t){document.querySelector(e.totalCalories).textContent=t},clearEditState:function(){UICtrl.clearInput(),document.querySelector(e.updateBtn).style.display="none",document.querySelector(e.deleteBtn).style.display="none",document.querySelector(e.backBtn).style.display="none",document.querySelector(e.addbtn).style.display="inline"},showEditState:function(){document.querySelector(e.updateBtn).style.display="inline",document.querySelector(e.deleteBtn).style.display="inline",document.querySelector(e.backBtn).style.display="inline",document.querySelector(e.addbtn).style.display="none"}}}(),App=function(e,t,n){const o=function(o){const i=n.getItemInput();if(""!==i.name&&""!==i.calories){const o=e.addItem(i.name,i.calories);n.addListItem(o);const r=e.getTotalCalories();n.showTotalCalories(r),t.storeItem(o),n.clearInput()}o.preventDefault()},i=function(t){if(t.target.classList.contains("edit-item")){const o=t.target.parentNode.parentNode.id.split("-"),i=parseInt(o[1]),r=e.getItemById(i);e.setCurrentItem(r),n.addItemToForm()}t.preventDefault()},r=function(o){const i=n.getItemInput(),r=e.updateItem(i.name,i.calories);n.updateListItem(r);const l=e.getTotalCalories();n.showTotalCalories(l),t.updateItemStorage(r),n.clearEditState(),o.preventDefault()},l=function(o){const i=e.getCurrentItem();e.deleteItem(i.id),n.deleteListItem(i.id);const r=e.getTotalCalories();n.showTotalCalories(r),t.deleteItemFromStorage(i.id),n.clearEditState(),o.preventDefault()},a=function(o){e.clearAllItems();const i=e.getTotalCalories();n.showTotalCalories(i),n.removeListItems(),t.clearItemsFromStorage(),n.hideList(),o.preventDefault()};return{init:function(){console.log("Initializing App..."),n.clearEditState();const t=e.getItems();0===t.length?n.hideList():n.populateItemList(t);const c=e.getTotalCalories();n.showTotalCalories(c),function(){const e=n.getSelectors();document.querySelector(e.addbtn).addEventListener("click",o),document.addEventListener("keypress",function(e){if(13===e.keyCode||13===e.which)return e.preventDefault(),!1}),document.querySelector(e.itemList).addEventListener("click",i),document.querySelector(e.updateBtn).addEventListener("click",r),document.querySelector(e.deleteBtn).addEventListener("click",l),document.querySelector(e.backBtn).addEventListener("click",n.clearEditState),document.querySelector(e.clearBtn).addEventListener("click",a)}()}}}(ItemCtrl,StorageCtrl,UICtrl);App.init();